{"ast":null,"code":"/*\n Highstock JS v10.0.0 (2022-03-07)\n\n Indicator series type for Highcharts Stock\n\n (c) 2010-2021 Pawe Dalek\n\n License: www.highcharts.com/license\n*/\n(function (b) {\n  \"object\" === typeof module && module.exports ? (b[\"default\"] = b, module.exports = b) : \"function\" === typeof define && define.amd ? define(\"highcharts/indicators/volume-by-price\", [\"highcharts\", \"highcharts/modules/stock\"], function (h) {\n    b(h);\n    b.Highcharts = h;\n    return b;\n  }) : b(\"undefined\" !== typeof Highcharts ? Highcharts : void 0);\n})(function (b) {\n  function h(b, d, h, q) {\n    b.hasOwnProperty(d) || (b[d] = q.apply(null, h), \"function\" === typeof CustomEvent && window.dispatchEvent(new CustomEvent(\"HighchartsModuleLoaded\", {\n      detail: {\n        path: d,\n        module: b[d]\n      }\n    })));\n  }\n\n  b = b ? b._modules : {};\n  h(b, \"Stock/Indicators/VBP/VBPPoint.js\", [b[\"Core/Series/Point.js\"], b[\"Core/Series/SeriesRegistry.js\"]], function (b, d) {\n    var h = this && this.__extends || function () {\n      var b = function (a, d) {\n        b = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (b, a) {\n          b.__proto__ = a;\n        } || function (b, a) {\n          for (var d in a) a.hasOwnProperty(d) && (b[d] = a[d]);\n        };\n\n        return b(a, d);\n      };\n\n      return function (a, d) {\n        function h() {\n          this.constructor = a;\n        }\n\n        b(a, d);\n        a.prototype = null === d ? Object.create(d) : (h.prototype = d.prototype, new h());\n      };\n    }();\n\n    return function (d) {\n      function a() {\n        return null !== d && d.apply(this, arguments) || this;\n      }\n\n      h(a, d);\n\n      a.prototype.destroy = function () {\n        this.negativeGraphic && (this.negativeGraphic = this.negativeGraphic.destroy());\n        return b.prototype.destroy.apply(this, arguments);\n      };\n\n      return a;\n    }(d.seriesTypes.sma.prototype.pointClass);\n  });\n  h(b, \"Stock/Indicators/VBP/VBPIndicator.js\", [b[\"Stock/Indicators/VBP/VBPPoint.js\"], b[\"Core/Animation/AnimationUtilities.js\"], b[\"Core/Globals.js\"], b[\"Core/Series/SeriesRegistry.js\"], b[\"Core/Utilities.js\"], b[\"Core/Chart/StockChart.js\"]], function (b, d, h, q, a, G) {\n    var H = this && this.__extends || function () {\n      var b = function (a, c) {\n        b = Object.setPrototypeOf || {\n          __proto__: []\n        } instanceof Array && function (c, b) {\n          c.__proto__ = b;\n        } || function (c, b) {\n          for (var e in b) b.hasOwnProperty(e) && (c[e] = b[e]);\n        };\n\n        return b(a, c);\n      };\n\n      return function (a, c) {\n        function u() {\n          this.constructor = a;\n        }\n\n        b(a, c);\n        a.prototype = null === c ? Object.create(c) : (u.prototype = c.prototype, new u());\n      };\n    }(),\n        I = d.animObject;\n\n    d = h.noop;\n    var B = q.seriesTypes.sma,\n        y = a.addEvent,\n        C = a.arrayMax,\n        J = a.arrayMin,\n        z = a.correctFloat,\n        D = a.defined,\n        A = a.error,\n        E = a.extend,\n        K = a.isArray,\n        L = a.merge,\n        v = Math.abs,\n        x = q.seriesTypes.column.prototype;\n\n    a = function (b) {\n      function a() {\n        var c = null !== b && b.apply(this, arguments) || this;\n        c.data = void 0;\n        c.negWidths = void 0;\n        c.options = void 0;\n        c.points = void 0;\n        c.posWidths = void 0;\n        c.priceZones = void 0;\n        c.rangeStep = void 0;\n        c.volumeDataArray = void 0;\n        c.zoneStarts = void 0;\n        c.zoneLinesSVG = void 0;\n        return c;\n      }\n\n      H(a, b);\n\n      a.prototype.init = function (c) {\n        var b = this,\n            a,\n            e,\n            l;\n        h.seriesTypes.sma.prototype.init.apply(b, arguments);\n        var r = y(G, \"afterLinkSeries\", function () {\n          b.options && (a = b.options.params, e = b.linkedParent, l = c.get(a.volumeSeriesID), b.addCustomEvents(e, l));\n          r();\n        }, {\n          order: 1\n        });\n        return b;\n      };\n\n      a.prototype.addCustomEvents = function (c, b) {\n        function a() {\n          e.chart.redraw();\n          e.setData([]);\n          e.zoneStarts = [];\n          e.zoneLinesSVG && (e.zoneLinesSVG = e.zoneLinesSVG.destroy());\n        }\n\n        var e = this;\n        e.dataEventsToUnbind.push(y(c, \"remove\", function () {\n          a();\n        }));\n        b && e.dataEventsToUnbind.push(y(b, \"remove\", function () {\n          a();\n        }));\n        return e;\n      };\n\n      a.prototype.animate = function (c) {\n        var b = this,\n            a = b.chart.inverted,\n            e = b.group,\n            l = {};\n        !c && e && (c = a ? b.yAxis.top : b.xAxis.left, a ? (e[\"forceAnimate:translateY\"] = !0, l.translateY = c) : (e[\"forceAnimate:translateX\"] = !0, l.translateX = c), e.animate(l, E(I(b.options.animation), {\n          step: function (c, a) {\n            b.group.attr({\n              scaleX: Math.max(.001, a.pos)\n            });\n          }\n        })));\n      };\n\n      a.prototype.drawPoints = function () {\n        this.options.volumeDivision.enabled && (this.posNegVolume(!0, !0), x.drawPoints.apply(this, arguments), this.posNegVolume(!1, !1));\n        x.drawPoints.apply(this, arguments);\n      };\n\n      a.prototype.posNegVolume = function (b, a) {\n        var c = a ? [\"positive\", \"negative\"] : [\"negative\", \"positive\"],\n            e = this.options.volumeDivision,\n            l = this.points.length,\n            r = [],\n            f = [],\n            k = 0,\n            d;\n        b ? (this.posWidths = r, this.negWidths = f) : (r = this.posWidths, f = this.negWidths);\n\n        for (; k < l; k++) {\n          var g = this.points[k];\n          g[c[0] + \"Graphic\"] = g.graphic;\n          g.graphic = g[c[1] + \"Graphic\"];\n\n          if (b) {\n            var u = g.shapeArgs.width;\n            var n = this.priceZones[k];\n            (d = n.wholeVolumeData) ? (r.push(u / d * n.positiveVolumeData), f.push(u / d * n.negativeVolumeData)) : (r.push(0), f.push(0));\n          }\n\n          g.color = a ? e.styles.positiveColor : e.styles.negativeColor;\n          g.shapeArgs.width = a ? this.posWidths[k] : this.negWidths[k];\n          g.shapeArgs.x = a ? g.shapeArgs.x : this.posWidths[k];\n        }\n      };\n\n      a.prototype.translate = function () {\n        var b = this,\n            a = b.options,\n            d = b.chart,\n            e = b.yAxis,\n            l = e.min,\n            r = b.options.zoneLines,\n            f = b.priceZones,\n            k = 0,\n            m,\n            g,\n            h;\n        x.translate.apply(b);\n        var n = b.points;\n\n        if (n.length) {\n          var F = .5 > a.pointPadding ? a.pointPadding : .1;\n          a = b.volumeDataArray;\n          var t = C(a);\n          var p = d.plotWidth / 2;\n          var M = d.plotTop;\n          var w = v(e.toPixels(l) - e.toPixels(l + b.rangeStep));\n          var q = v(e.toPixels(l) - e.toPixels(l + b.rangeStep));\n          F && (l = v(w * (1 - 2 * F)), k = v((w - l) / 2), w = v(l));\n          n.forEach(function (a, c) {\n            g = a.barX = a.plotX = 0;\n            h = a.plotY = e.toPixels(f[c].start) - M - (e.reversed ? w - q : w) - k;\n            m = z(p * f[c].wholeVolumeData / t);\n            a.pointWidth = m;\n            a.shapeArgs = b.crispCol.apply(b, [g, h, m, w]);\n            a.volumeNeg = f[c].negativeVolumeData;\n            a.volumePos = f[c].positiveVolumeData;\n            a.volumeAll = f[c].wholeVolumeData;\n          });\n          r.enabled && b.drawZones(d, e, b.zoneStarts, r.styles);\n        }\n      };\n\n      a.prototype.getValues = function (b, a) {\n        var c = b.processedXData,\n            e = b.processedYData,\n            d = this.chart,\n            r = a.ranges,\n            f = [],\n            k = [],\n            m = [],\n            g;\n        if (b.chart) {\n          if (g = d.get(a.volumeSeriesID)) {\n            if ((a = K(e[0])) && 4 !== e[0].length) A(\"Type of \" + b.name + \" series is different than line, OHLC or candlestick.\", !0, d);else return (this.priceZones = this.specifyZones(a, c, e, r, g)).forEach(function (b, a) {\n              f.push([b.x, b.end]);\n              k.push(f[a][0]);\n              m.push(f[a][1]);\n            }), {\n              values: f,\n              xData: k,\n              yData: m\n            };\n          } else A(\"Series \" + a.volumeSeriesID + \" not found! Check `volumeSeriesID`.\", !0, d);\n        } else A(\"Base series not found! In case it has been removed, add a new one.\", !0, d);\n      };\n\n      a.prototype.specifyZones = function (b, a, d, e, l) {\n        if (b) {\n          var c = d.length;\n\n          for (var f = d[0][3], k = f, m = 1, g; m < c; m++) g = d[m][3], g < f && (f = g), g > k && (k = g);\n\n          c = {\n            min: f,\n            max: k\n          };\n        } else c = !1;\n\n        c = (f = c) ? f.min : J(d);\n        g = f ? f.max : C(d);\n        f = this.zoneStarts = [];\n        k = [];\n        var h = 0;\n        m = 1;\n        var n = this.linkedParent;\n        !this.options.compareToMain && n.dataModify && (c = n.dataModify.modifyValue(c), g = n.dataModify.modifyValue(g));\n        if (!D(c) || !D(g)) return this.points.length && (this.setData([]), this.zoneStarts = [], this.zoneLinesSVG && (this.zoneLinesSVG = this.zoneLinesSVG.destroy())), [];\n        n = this.rangeStep = z(g - c) / e;\n\n        for (f.push(c); h < e - 1; h++) f.push(z(f[h] + n));\n\n        f.push(g);\n\n        for (e = f.length; m < e; m++) k.push({\n          index: m - 1,\n          x: a[0],\n          start: f[m - 1],\n          end: f[m]\n        });\n\n        return this.volumePerZone(b, k, l, a, d);\n      };\n\n      a.prototype.volumePerZone = function (b, a, d, e, l) {\n        var c = this,\n            f = d.processedXData,\n            k = d.processedYData,\n            h = a.length - 1,\n            g = l.length;\n        d = k.length;\n        var q, n, u, t, p;\n        v(g - d) && (e[0] !== f[0] && k.unshift(0), e[g - 1] !== f[d - 1] && k.push(0));\n        c.volumeDataArray = [];\n        a.forEach(function (a) {\n          a.wholeVolumeData = 0;\n          a.positiveVolumeData = 0;\n\n          for (p = a.negativeVolumeData = 0; p < g; p++) {\n            u = n = !1;\n            t = b ? l[p][3] : l[p];\n            q = p ? b ? l[p - 1][3] : l[p - 1] : t;\n            var d = c.linkedParent;\n            !c.options.compareToMain && d.dataModify && (t = d.dataModify.modifyValue(t), q = d.dataModify.modifyValue(q));\n            t <= a.start && 0 === a.index && (n = !0);\n            t >= a.end && a.index === h && (u = !0);\n            (t > a.start || n) && (t < a.end || u) && (a.wholeVolumeData += k[p], q > t ? a.negativeVolumeData += k[p] : a.positiveVolumeData += k[p]);\n          }\n\n          c.volumeDataArray.push(a.wholeVolumeData);\n        });\n        return a;\n      };\n\n      a.prototype.drawZones = function (a, b, d, e) {\n        var c = a.renderer,\n            h = this.zoneLinesSVG,\n            f = [],\n            k = a.plotWidth,\n            m = a.plotTop,\n            g;\n        d.forEach(function (c) {\n          g = b.toPixels(c) - m;\n          f = f.concat(a.renderer.crispLine([[\"M\", 0, g], [\"L\", k, g]], e.lineWidth));\n        });\n        h ? h.animate({\n          d: f\n        }) : h = this.zoneLinesSVG = c.path(f).attr({\n          \"stroke-width\": e.lineWidth,\n          stroke: e.color,\n          dashstyle: e.dashStyle,\n          zIndex: this.group.zIndex + .1\n        }).add(this.group);\n      };\n\n      a.defaultOptions = L(B.defaultOptions, {\n        params: {\n          index: void 0,\n          period: void 0,\n          ranges: 12,\n          volumeSeriesID: \"volume\"\n        },\n        zoneLines: {\n          enabled: !0,\n          styles: {\n            color: \"#0A9AC9\",\n            dashStyle: \"LongDash\",\n            lineWidth: 1\n          }\n        },\n        volumeDivision: {\n          enabled: !0,\n          styles: {\n            positiveColor: \"rgba(144, 237, 125, 0.8)\",\n            negativeColor: \"rgba(244, 91, 91, 0.8)\"\n          }\n        },\n        animationLimit: 1E3,\n        enableMouseTracking: !1,\n        pointPadding: 0,\n        zIndex: -1,\n        crisp: !0,\n        dataGrouping: {\n          enabled: !1\n        },\n        dataLabels: {\n          allowOverlap: !0,\n          enabled: !0,\n          format: \"P: {point.volumePos:.2f} | N: {point.volumeNeg:.2f}\",\n          padding: 0,\n          style: {\n            fontSize: \"7px\"\n          },\n          verticalAlign: \"top\"\n        }\n      });\n      return a;\n    }(B);\n\n    E(a.prototype, {\n      nameBase: \"Volume by Price\",\n      nameComponents: [\"ranges\"],\n      calculateOn: {\n        chart: \"render\",\n        xAxis: \"afterSetExtremes\"\n      },\n      pointClass: b,\n      markerAttribs: d,\n      drawGraph: d,\n      getColumnMetrics: x.getColumnMetrics,\n      crispCol: x.crispCol\n    });\n    q.registerSeriesType(\"vbp\", a);\n    \"\";\n    return a;\n  });\n  h(b, \"masters/indicators/volume-by-price.src.js\", [], function () {});\n}); //# sourceMappingURL=volume-by-price.js.map","map":null,"metadata":{},"sourceType":"script"}