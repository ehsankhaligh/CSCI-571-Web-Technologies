{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../backend.service\";\nimport * as i3 from \"@angular/common\";\n\nfunction WatchListSectionComponent_ng_template_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13);\n    i0.ɵɵtext(1, \" Currently you don't have any stock in you watchlist. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction WatchListSectionComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 14)(1, \"h2\", 15)(2, \"u\", 16);\n    i0.ɵɵlistener(\"click\", function WatchListSectionComponent_div_16_Template_u_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const item_r2 = restoredCtx.$implicit;\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.onclickArea(item_r2.ticker);\n    });\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementStart(6, \"button\", 17)(7, \"span\", 18);\n    i0.ɵɵlistener(\"click\", function WatchListSectionComponent_div_16_Template_span_click_7_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r4);\n      const item_r2 = restoredCtx.$implicit;\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.deleteItem(item_r2.ticker);\n    });\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(8, \"h3\", 19);\n    i0.ɵɵtext(9);\n    i0.ɵɵelement(10, \"link\", 20);\n    i0.ɵɵelementStart(11, \"span\");\n    i0.ɵɵelement(12, \"span\", 21);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(14, \"link\", 20);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r2 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\", item_r2.ticker, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵstyleMapInterpolate1(\"color:\", item_r2.color, \"; display:inline; float:right\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", item_r2.c, \" \");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\" \", item_r2.name, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵstyleMapInterpolate1(\"color:\", item_r2.color, \"; display:inline; float:right\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngClass\", !ctx_r1.arrowflag ? \"bi bi-caret-up-fill green-color\" : \"bi bi-caret-down-fill red-color\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", item_r2.d, \" ( \", item_r2.dp, \" %)\");\n  }\n}\n\nexport let WatchListSectionComponent = /*#__PURE__*/(() => {\n  class WatchListSectionComponent {\n    constructor(router, backendServiceReq) {\n      this.router = router;\n      this.backendServiceReq = backendServiceReq;\n      this.json_display = [];\n      this.stockPrice = []; //populate from json\n    }\n\n    onclickArea(ticker) {\n      let trimed_ticker = ticker.replace(' ', ''); //remove space\n\n      this.router.navigateByUrl('/details/' + trimed_ticker);\n    }\n\n    deleteItem(displayTicker) {\n      if (localStorage.getItem(\"items\") != null) {\n        console.log(\"~after if\");\n        let storedItems = localStorage.getItem(\"items\");\n        storedItems = storedItems.replace('\"', '');\n        storedItems = storedItems.replace(']', '');\n        storedItems = storedItems.replace('[', '');\n        let storedItemsList = storedItems.split(\",\");\n        console.log(\"~storedItems:\", storedItems);\n        console.log(\"~storedItemsList:\", storedItemsList);\n\n        for (let i = 0; i < storedItemsList.length; i += 1) {\n          let str_tmp = storedItemsList[i];\n          console.log(\"~str_tmp:\", str_tmp);\n\n          if (str_tmp.includes(displayTicker) == true) {\n            let delIndex = i;\n            console.log(\"if ...\");\n            let watchList = JSON.parse(localStorage.getItem(\"items\"));\n            console.log(\"^^Before Delete watchList:\", watchList);\n            console.log(\"^^Before Delete delIndex:\", delIndex);\n            storedItemsList.pop();\n            console.log(\"^^Before Delete storedItemsList:\", storedItemsList);\n            storedItemsList.splice(delIndex, 1);\n            console.log(\"^^After Delete delIndex:\", storedItemsList);\n            localStorage.setItem(\"items\", JSON.stringify(storedItemsList));\n            console.log(\"^^After Delete watchList:\", watchList); //window.location.reload();\n          }\n        }\n      }\n    }\n\n    onload() {\n      console.log(\"**localStorage.getItem(\\\"balance\\\")\", localStorage.getItem(\"balance\"));\n\n      if (localStorage.getItem(\"balance\") == null) {\n        localStorage.setItem(\"balance\", \"25000\");\n        console.log(\"**localStorage.getItem(\\\"balance\\\")\", localStorage.getItem(\"balance\"));\n      }\n\n      this.watchLocalStorage = localStorage.getItem(\"items\");\n      let jsonLocalStore = JSON.parse(localStorage.getItem(\"items\"));\n      console.log(\"** 1) watchLocalStorage\", this.watchLocalStorage);\n      console.log(\"## 1) jsonLocalStore\", jsonLocalStore); //here\n      //if((localStorage.getItem(\"items\") == null) || (this.watchLocalStorage == '[]') || (this.watchLocalStorage == \"['']\")){\n\n      if (localStorage.getItem(\"items\") == null) {\n        this.warndisplayflag = false;\n      } else {\n        console.log(\"1) watchLocalStorage\", typeof this.watchLocalStorage);\n        this.watchLocalStorage = this.watchLocalStorage.replace(']', '');\n        this.watchLocalStorage = this.watchLocalStorage.replace('[', '');\n        this.watchLocalStorage = this.watchLocalStorage.replace(\"'\", \"\");\n        this.watchLocalStorage = this.watchLocalStorage.replace(\"\\\"\", \"\");\n        this.watchLocalStorage = this.watchLocalStorage.replace(\" \", \"\");\n        let storedItemsList = this.watchLocalStorage.split(\",\");\n        storedItemsList.pop();\n        console.log(\"**storedItemsList:\", storedItemsList);\n        console.log(\"--------------------\");\n\n        for (let i = 0; i < storedItemsList.length; i += 1) {\n          storedItemsList[i] = storedItemsList[i].replace('\\\"', ''); //change later\n\n          console.log(\"**storedItemsList:\", storedItemsList[i]);\n          let str_tmp_list = storedItemsList[i].split(\"|\");\n          console.log(\"**str_tmp_list:\", str_tmp_list);\n\n          for (let j = 0; j < str_tmp_list.length; j += 5) {\n            let color;\n            console.log(\"1)**j:\", j);\n            console.log(\"1)item:\", str_tmp_list[j]); //getStockPriceInfo(ticker name )\n\n            /*\n            this.backendServiceReq.getStockPriceInfo(str_tmp_list[j]).subscribe(data => {\n              this.stockPrice = data;\n              if(this.stockPrice.length != 0){\n                     var date = new Date(this.stockPrice[\"t\"]*1000);\n                let time = date.getFullYear() + \"-\" + date.getMonth() + \"-\" + date.getDate() + \" \" + date.getHours()  + \":\" + date.getMinutes() + \":\" + date.getSeconds();\n                     this.stockPrice[\"t\"] = time;\n                let hh_mm_ss = date.getHours()  + \":\";\n                     //round two Decimals\n                this.stockPrice[\"dp\"] = Math.round(this.stockPrice[\"dp\"] * 100) / 100;\n                     if(this.stockPrice[\"dp\"]< 0){\n                  color = \"red\";\n                  this.arrowflag = true;\n                } else{\n                  color = \"green\";\n                  this.arrowflag = false;\n                }\n                   }\n                   this.json_display.push({ ticker: str_tmp_list[j],\n                                       name: str_tmp_list[j+1],\n                                       c: this.stockPrice[\"c\"],\n                                       d: this.stockPrice[\"d\"],\n                                       dp: this.stockPrice[\"dp\"],\n                                       color: color\n              });\n                 });*/\n            //dp\n\n            if (str_tmp_list[j + 4] < 0) {\n              color = \"red\";\n              this.arrowflag = true;\n            } else {\n              color = \"green\";\n              this.arrowflag = false;\n            }\n\n            this.json_display.push({\n              ticker: str_tmp_list[j],\n              name: str_tmp_list[j + 1],\n              c: str_tmp_list[j + 2],\n              d: str_tmp_list[j + 3],\n              dp: str_tmp_list[j + 4],\n              color: color\n            });\n          }\n\n          this.warndisplayflag = true;\n          console.log(\"@@this.warndisplayflag:\", this.warndisplayflag);\n          console.log(\"this.json_display:\", this.json_display);\n          console.log(\"--------------------\");\n        }\n\n        console.log(\"this.json_display:\", this.json_display);\n      }\n    }\n\n    ngOnInit() {\n      this.onload();\n    }\n\n  }\n\n  WatchListSectionComponent.ɵfac = function WatchListSectionComponent_Factory(t) {\n    return new (t || WatchListSectionComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.BackendService));\n  };\n\n  WatchListSectionComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: WatchListSectionComponent,\n    selectors: [[\"app-watch-list-section\"]],\n    decls: 21,\n    vars: 2,\n    consts: [[\"lang\", \"en\"], [\"charset\", \"utf-8\"], [\"name\", \"viewport\", \"content\", \"width=device-width, initial-scale=1\"], [\"id\", \"page-container\"], [\"id\", \"content-wrap\"], [\"id\", \"backgroundimage\"], [\"id\", \"topInfo\", 1, \"card\"], [1, \"card-header\"], [2, \"font-size\", \"20px\"], [3, \"ngIf\"], [\"class\", \"card-body\", 4, \"ngFor\", \"ngForOf\"], [\"id\", \"footer\", 2, \"background-color\", \"rgb(115, 147, 179)\"], [\"href\", \" https://finnhub.io\", \"target\", \"_blank\"], [\"ngif\", \"flagwarnBox == 12\", \"role\", \"alert\", 1, \"alert\", \"alert-warning\"], [1, \"card-body\"], [1, \"card-text\", 2, \"color\", \"blue\"], [3, \"click\"], [\"type\", \"button\", \"id\", \"mybtn\", 1, \"btn\", \"btn-link\"], [1, \"bi\", \"bi-x\", 3, \"click\"], [1, \"card-title\"], [\"rel\", \"stylesheet\", \"href\", \"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css\"], [3, \"ngClass\"]],\n    template: function WatchListSectionComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"html\", 0)(1, \"head\")(2, \"title\");\n        i0.ɵɵtext(3, \"Bootstrap Example\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(4, \"meta\", 1)(5, \"meta\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"body\")(7, \"div\", 3)(8, \"div\", 4);\n        i0.ɵɵelement(9, \"div\", 5);\n        i0.ɵɵelementStart(10, \"div\", 6)(11, \"div\", 7)(12, \"span\", 8)(13, \"Strong\");\n        i0.ɵɵtext(14, \"My Watch List\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵtemplate(15, WatchListSectionComponent_ng_template_15_Template, 2, 0, \"ng-template\", 9);\n        i0.ɵɵtemplate(16, WatchListSectionComponent_div_16_Template, 15, 12, \"div\", 10);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(17, \"footer\", 11);\n        i0.ɵɵtext(18, \"Powered by \");\n        i0.ɵɵelementStart(19, \"a\", 12);\n        i0.ɵɵtext(20, \"Finnhub.io\");\n        i0.ɵɵelementEnd()()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(15);\n        i0.ɵɵproperty(\"ngIf\", ctx.warndisplayflag == false);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.json_display);\n      }\n    },\n    directives: [i3.NgIf, i3.NgForOf, i3.NgClass],\n    styles: [\"#backgroundimage[_ngcontent-%COMP%]{background:url(background-graph.jpg);margin-top:auto;margin-left:auto;width:100%;height:100%;background-repeat:repeat-y;display:block;position:absolute;background-position:center;background-size:cover}#page-container[_ngcontent-%COMP%]{position:relative;min-height:100vh}#content-wrap[_ngcontent-%COMP%]{padding-bottom:2.5rem}#footer[_ngcontent-%COMP%]{position:absolute;bottom:0;text-align:center;width:100%;height:2.5rem}#topInfo[_ngcontent-%COMP%]{margin-left:15%;margin-right:15%}\"]\n  });\n  return WatchListSectionComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}